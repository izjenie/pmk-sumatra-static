{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/izakjenie/Programming/pmk-sumatra-static/src/components/MapComponent.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useRef, useState } from 'react';\nimport L from 'leaflet';\n\ninterface MapMarker {\n  id: number;\n  latitude: number;\n  longitude: number;\n  marker_type: string;\n  label: string;\n}\n\nexport default function MapComponent() {\n  const mapRef = useRef<L.Map | null>(null);\n  const mapContainerRef = useRef<HTMLDivElement>(null);\n  const [markers, setMarkers] = useState<MapMarker[]>([]);\n\n  useEffect(() => {\n    fetchMarkers();\n  }, []);\n\n  const fetchMarkers = async () => {\n    try {\n      const res = await fetch('/api/markers');\n      if (res.ok) {\n        const data = await res.json();\n        setMarkers(data);\n      }\n    } catch (error) {\n      console.error('Error fetching markers:', error);\n    }\n  };\n\n  useEffect(() => {\n    if (!mapContainerRef.current || mapRef.current) return;\n\n    const sumateraBounds: L.LatLngBoundsExpression = [\n      [-6.5, 94.5],\n      [6.0, 107.5]\n    ];\n\n    const satellite = L.tileLayer(\n      'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',\n      {\n        maxZoom: 19,\n        attribution: 'Tiles Â© Esri'\n      }\n    );\n\n    const map = L.map(mapContainerRef.current, {\n      center: [0.5, 102.0],\n      zoom: 7,\n      minZoom: 6,\n      maxZoom: 11,\n      maxBounds: sumateraBounds,\n      maxBoundsViscosity: 1.0,\n      layers: [satellite]\n    });\n\n    mapRef.current = map;\n\n    return () => {\n      if (mapRef.current) {\n        mapRef.current.remove();\n        mapRef.current = null;\n      }\n    };\n  }, []);\n\n  useEffect(() => {\n    if (!mapRef.current || markers.length === 0) return;\n\n    const getIcon = (type: string) => {\n      const iconClass = {\n        flood: 'text-blue-600 fa-solid fa-water',\n        truck: 'text-green-600 fa-solid fa-truck',\n        tent: 'text-orange-600 fa-solid fa-tent'\n      }[type] || 'text-red-600 fa-solid fa-location-dot';\n\n      return L.divIcon({\n        className: iconClass + ' text-xl',\n        iconSize: [24, 24],\n        iconAnchor: [12, 12]\n      });\n    };\n\n    markers.forEach(marker => {\n      L.marker([marker.latitude, marker.longitude], { \n        icon: getIcon(marker.marker_type) \n      })\n        .addTo(mapRef.current!)\n        .bindPopup(marker.label || 'No label');\n    });\n  }, [markers]);\n\n  return (\n    <div \n      ref={mapContainerRef} \n      className=\"h-[520px] sm:h-[650px] md:h-[768px] rounded-xl\"\n    />\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;;;AAHA;;;AAae,SAAS;;IACtB,MAAM,SAAS,IAAA,uKAAM,EAAe;IACpC,MAAM,kBAAkB,IAAA,uKAAM,EAAiB;IAC/C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAc,EAAE;IAEtD,IAAA,0KAAS;kCAAC;YACR;QACF;iCAAG,EAAE;IAEL,MAAM,eAAe;QACnB,IAAI;YACF,MAAM,MAAM,MAAM,MAAM;YACxB,IAAI,IAAI,EAAE,EAAE;gBACV,MAAM,OAAO,MAAM,IAAI,IAAI;gBAC3B,WAAW;YACb;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,2BAA2B;QAC3C;IACF;IAEA,IAAA,0KAAS;kCAAC;YACR,IAAI,CAAC,gBAAgB,OAAO,IAAI,OAAO,OAAO,EAAE;YAEhD,MAAM,iBAA2C;gBAC/C;oBAAC,CAAC;oBAAK;iBAAK;gBACZ;oBAAC;oBAAK;iBAAM;aACb;YAED,MAAM,YAAY,+JAAC,CAAC,SAAS,CAC3B,iGACA;gBACE,SAAS;gBACT,aAAa;YACf;YAGF,MAAM,MAAM,+JAAC,CAAC,GAAG,CAAC,gBAAgB,OAAO,EAAE;gBACzC,QAAQ;oBAAC;oBAAK;iBAAM;gBACpB,MAAM;gBACN,SAAS;gBACT,SAAS;gBACT,WAAW;gBACX,oBAAoB;gBACpB,QAAQ;oBAAC;iBAAU;YACrB;YAEA,OAAO,OAAO,GAAG;YAEjB;0CAAO;oBACL,IAAI,OAAO,OAAO,EAAE;wBAClB,OAAO,OAAO,CAAC,MAAM;wBACrB,OAAO,OAAO,GAAG;oBACnB;gBACF;;QACF;iCAAG,EAAE;IAEL,IAAA,0KAAS;kCAAC;YACR,IAAI,CAAC,OAAO,OAAO,IAAI,QAAQ,MAAM,KAAK,GAAG;YAE7C,MAAM;kDAAU,CAAC;oBACf,MAAM,YAAY;wBAChB,OAAO;wBACP,OAAO;wBACP,MAAM;oBACR,CAAC,CAAC,KAAK,IAAI;oBAEX,OAAO,+JAAC,CAAC,OAAO,CAAC;wBACf,WAAW,YAAY;wBACvB,UAAU;4BAAC;4BAAI;yBAAG;wBAClB,YAAY;4BAAC;4BAAI;yBAAG;oBACtB;gBACF;;YAEA,QAAQ,OAAO;0CAAC,CAAA;oBACd,+JAAC,CAAC,MAAM,CAAC;wBAAC,OAAO,QAAQ;wBAAE,OAAO,SAAS;qBAAC,EAAE;wBAC5C,MAAM,QAAQ,OAAO,WAAW;oBAClC,GACG,KAAK,CAAC,OAAO,OAAO,EACpB,SAAS,CAAC,OAAO,KAAK,IAAI;gBAC/B;;QACF;iCAAG;QAAC;KAAQ;IAEZ,qBACE,6LAAC;QACC,KAAK;QACL,WAAU;;;;;;AAGhB;GAzFwB;KAAA"}}]
}